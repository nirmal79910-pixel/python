{% extends "base.html" %}

{% block title %}Password Generator - Portfolio Tools{% endblock %}

{% block content %}
<section class="tool-page">
    <div class="tool-header">
        <h1>Password Generator</h1>
        <p>Generate secure, random passwords to keep your accounts safe.</p>
    </div>

    <div class="calculator-container">
        <div class="password-display">
            <input type="text" id="generated-password" readonly placeholder="Click Generate to create a password">
            <button type="button" id="copy-btn" class="copy-btn" title="Copy to clipboard">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2"/>
                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                </svg>
            </button>
        </div>
        <div id="copy-feedback" class="copy-feedback">Copied!</div>

        <div class="password-options">
            <div class="option-group">
                <label for="length-slider">Password Length: <span id="length-value">16</span></label>
                <input type="range" id="length-slider" min="8" max="32" value="16" class="slider">
                <div class="slider-labels">
                    <span>8</span>
                    <span>32</span>
                </div>
            </div>

            <div class="checkbox-options">
                <label class="checkbox-label">
                    <input type="checkbox" id="uppercase" checked>
                    <span class="checkmark"></span>
                    Include Uppercase (A-Z)
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="numbers" checked>
                    <span class="checkmark"></span>
                    Include Numbers (0-9)
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="symbols" checked>
                    <span class="checkmark"></span>
                    Include Symbols (!@#$%...)
                </label>
            </div>
        </div>

        <button type="button" id="generate-btn" class="submit-btn">
            Generate Password
            <span class="btn-shine"></span>
        </button>

        <div class="password-strength" id="strength-container" style="display: none;">
            <h4>Password Strength</h4>
            <div class="strength-bar">
                <div class="strength-fill" id="strength-fill"></div>
            </div>
            <span class="strength-label" id="strength-label">Strong</span>
        </div>

        <div class="info-card">
            <h3>Password Security Tips</h3>
            <ul class="tips-list">
                <li>Use a unique password for each account</li>
                <li>Longer passwords are generally more secure</li>
                <li>Mix uppercase, lowercase, numbers, and symbols</li>
                <li>Avoid using personal information in passwords</li>
                <li>Consider using a password manager</li>
            </ul>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const lengthSlider = document.getElementById('length-slider');
    const lengthValue = document.getElementById('length-value');
    const generateBtn = document.getElementById('generate-btn');
    const copyBtn = document.getElementById('copy-btn');
    const passwordInput = document.getElementById('generated-password');
    const copyFeedback = document.getElementById('copy-feedback');
    const strengthContainer = document.getElementById('strength-container');
    const strengthFill = document.getElementById('strength-fill');
    const strengthLabel = document.getElementById('strength-label');

    lengthSlider.addEventListener('input', function() {
        lengthValue.textContent = this.value;
    });

    generateBtn.addEventListener('click', async function() {
        const length = lengthSlider.value;
        const uppercase = document.getElementById('uppercase').checked;
        const numbers = document.getElementById('numbers').checked;
        const symbols = document.getElementById('symbols').checked;

        try {
            const response = await fetch('/api/generate-password', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    length: parseInt(length),
                    uppercase: uppercase,
                    numbers: numbers,
                    symbols: symbols
                })
            });

            const data = await response.json();
            if (data.success) {
                passwordInput.value = data.password;
                updateStrength(data.password, uppercase, numbers, symbols);
            }
        } catch (error) {
            console.error('Error generating password:', error);
        }
    });

    copyBtn.addEventListener('click', function() {
        if (passwordInput.value) {
            navigator.clipboard.writeText(passwordInput.value).then(() => {
                copyFeedback.classList.add('show');
                setTimeout(() => {
                    copyFeedback.classList.remove('show');
                }, 2000);
            });
        }
    });

    function updateStrength(password, hasUpper, hasNumbers, hasSymbols) {
        strengthContainer.style.display = 'block';
        let strength = 0;
        
        if (password.length >= 8) strength += 1;
        if (password.length >= 12) strength += 1;
        if (password.length >= 16) strength += 1;
        if (hasUpper) strength += 1;
        if (hasNumbers) strength += 1;
        if (hasSymbols) strength += 1;

        let percentage, label, color;
        if (strength <= 2) {
            percentage = 25;
            label = 'Weak';
            color = '#ef4444';
        } else if (strength <= 4) {
            percentage = 50;
            label = 'Medium';
            color = '#f59e0b';
        } else if (strength <= 5) {
            percentage = 75;
            label = 'Strong';
            color = '#22c55e';
        } else {
            percentage = 100;
            label = 'Very Strong';
            color = '#10b981';
        }

        strengthFill.style.width = percentage + '%';
        strengthFill.style.backgroundColor = color;
        strengthLabel.textContent = label;
        strengthLabel.style.color = color;
    }

    generateBtn.click();
});
</script>
{% endblock %}
